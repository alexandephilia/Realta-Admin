<h4 class="mb-3 text-body mb-0">Megamenu Management</h4>
<div class="card">
    <div class="card-body">
        <!-- Edit Megamenu Button -->
        <div class="text-end mb-3">
            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editMegamenuModal">
                <span class="fas fa-edit me-2"></span>Add Megamenu
            </button>
        </div>

        <!-- Categories Table -->
        <div class="table-responsive mt-4">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th class="text-center">Image</th>
                        <th class="text-center">Title</th>
                        <th class="text-center">Description</th>
                        <th class="text-center">Active</th>
                        <th class="text-center">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-center">
                            <img src="assets/img/gallery/15.png" alt="Technology" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                        </td>
                        <td class="text-center">Technology</td>
                        <td class="text-center">Latest technology news and updates</td>
                        <td class="text-center">
                            <span class="badge badge-phoenix fs-10 badge-phoenix-success">
                                <span class="fa fa-check"></span>
                            </span>
                        </td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-falcon-default text-danger" data-bs-toggle="modal" data-bs-target="#deleteCategoryModal">
                                <span class="fas fa-trash-alt"></span>
                            </button>
                            <button class="btn btn-sm btn-falcon-default text-warning" data-bs-toggle="modal" data-bs-target="#editCategoryModal">
                                <span class="fas fa-edit me-2"></span>Edit
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            <img src="assets/img/gallery/19.png" alt="Cloud" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                        </td>
                        <td class="text-center">Cloud</td>
                        <td class="text-center">Cloud computing and services</td>
                        <td class="text-center">
                            <span class="badge badge-phoenix fs-10 badge-phoenix-success">
                                <span class="fa fa-check"></span>
                            </span>
                        </td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-falcon-default text-danger" data-bs-toggle="modal" data-bs-target="#deleteCategoryModal">
                                <span class="fas fa-trash-alt"></span>
                            </button>
                            <button class="btn btn-sm btn-falcon-default text-warning" data-bs-toggle="modal" data-bs-target="#editCategoryModal">
                                <span class="fas fa-edit me-2"></span>Edit
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Add/Edit Megamenu Modal -->
<div class="modal fade" id="editMegamenuModal" tabindex="-1" aria-labelledby="editMegamenuModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editMegamenuModalLabel">Add Megamenu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editMegamenuForm">
                    <div class="row g-3">
                        <!-- Image Upload Section - Now Full Width at Top -->
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body p-3">
                                    <h6 class="mb-3">Menu Image</h6>
                                    <div class="image-upload-container">
                                        <div class="preview-area" style="width: 100%; height: 200px; border: 2px dashed #dee2e6; border-radius: 8px; overflow: hidden; position: relative; background: #f8f9fa; display: flex; align-items: center; justify-content: center;">
                                            <img id="menuImagePreview" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Preview" style="max-width: 100%; object-fit: cover; position: relative; z-index: 1;">
                                            <div id="uploadText" class="upload-text" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; z-index: 2; width: 100%;">
                                                <span class="fas fa-cloud-upload-alt fs-2"></span>
                                                <p class="mb-0 mt-2">Click or drag image here</p>
                                                <small class="text-muted d-block mt-1">Recommended: 50x50px</small>
                                            </div>
                                        </div>
                                        <input type="file" class="d-none" id="menuImageUpload" accept="image/*">
                                        <div class="d-flex justify-content-between align-items-center mt-2">
                                            <small class="text-muted">JPG, PNG, SVG</small>
                                            <div>
                                                <button type="button" class="btn btn-falcon-default btn-sm" onclick="document.getElementById('menuImageUpload').click()">
                                                    <span class="fas fa-upload me-1"></span>Choose
                                                </button>
                                                <button type="button" id="removeImage" class="btn btn-link btn-sm text-danger d-none">
                                                    <span class="fas fa-times me-1"></span>Remove
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Fields -->
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="mb-0">Menu</h6>
                                        <div class="d-flex align-items-center gap-2">
                                            <span class="text-body fw-semibold fs-sm">List</span>
                                            <div class="form-check form-switch mb-0">
                                                <input class="form-check-input" type="checkbox" id="menuTypeSwitch" 
                                                       style="width: 32px; height: 16px; cursor: pointer;">
                                            </div>
                                            <span class="text-body fw-semibold fs-sm">Text</span>
                                        </div>
                                    </div>
                                    <div class="row g-3">
                                        <!-- Title -->
                                        <div class="col-12">
                                            <label class="form-label" for="menuTitle">Menu Title</label>
                                            <input type="text" class="form-control" id="menuTitle" required>
                                        </div>

                                        <!-- Description (shown only in Text mode) -->
                                        <div class="col-12" id="descriptionField">
                                            <label class="form-label" for="menuDescription">Description</label>
                                            <textarea class="form-control" id="menuDescription" rows="3" required></textarea>
                                        </div>

                                        <!-- List Fields (shown only in List mode) -->
                                        <div class="col-12 d-none" id="listFields">
                                            <div class="row g-3">
                                                <!-- Column 1 -->
                                                <div class="col-md-4">
                                                    <label class="form-label">Column 1</label>
                                                    <div class="list-group-item p-3 mb-2">
                                                        <input type="text" class="form-control mb-2" placeholder="Link Title 1">
                                                        <input type="url" class="form-control mb-2" placeholder="URL 1">
                                                        <button type="button" class="btn btn-falcon-default btn-sm w-100">
                                                            <span class="fas fa-plus me-1"></span>Add Link
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <!-- Column 2 -->
                                                <div class="col-md-4">
                                                    <label class="form-label">Column 2</label>
                                                    <div class="list-group-item p-3 mb-2">
                                                        <input type="text" class="form-control mb-2" placeholder="Link Title 2">
                                                        <input type="url" class="form-control mb-2" placeholder="URL 2">
                                                        <button type="button" class="btn btn-falcon-default btn-sm w-100">
                                                            <span class="fas fa-plus me-1"></span>Add Link
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <!-- Column 3 -->
                                                <div class="col-md-4">
                                                    <label class="form-label">Column 3</label>
                                                    <div class="list-group-item p-3 mb-2">
                                                        <input type="text" class="form-control mb-2" placeholder="Link Title 3">
                                                        <input type="url" class="form-control mb-2" placeholder="URL 3">
                                                        <button type="button" class="btn btn-falcon-default btn-sm w-100">
                                                            <span class="fas fa-plus me-1"></span>Add Link
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- URL -->
                                        <div class="col-12">
                                            <label class="form-label" for="menuUrl">URL</label>
                                            <input type="url" class="form-control" id="menuUrl" placeholder="https://">
                                        </div>

                                        <!-- Status Switch -->
                                        <div class="col-12">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="menuStatus" checked>
                                                <label class="form-check-label" for="menuStatus">
                                                    Menu Status
                                                    <span class="ms-1 text-success status-text">Active</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="editMegamenuForm" class="btn btn-primary">Save Menu</button>
            </div>
        </div>
    </div>
</div>

<!-- Add this script at the bottom of the file -->
<script>
    // Handle image upload preview
    document.getElementById('menuImageUpload').addEventListener('change', function(e) {
        if (e.target.files && e.target.files[0]) {
            const reader = new FileReader();
            const preview = document.getElementById('menuImagePreview');
            const uploadText = document.getElementById('uploadText');
            const removeButton = document.getElementById('removeImage');

            reader.onload = function(e) {
                preview.src = e.target.result;
                uploadText.style.display = 'none';
                removeButton.classList.remove('d-none');
            };

            reader.readAsDataURL(e.target.files[0]);
        }
    });

    // Handle image removal
    document.getElementById('removeImage').addEventListener('click', function() {
        const preview = document.getElementById('menuImagePreview');
        const uploadText = document.getElementById('uploadText');
        const fileInput = document.getElementById('menuImageUpload');
        
        preview.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
        uploadText.style.display = 'block';
        this.classList.add('d-none');
        fileInput.value = '';
    });

    // Handle status toggle
    document.getElementById('menuStatus').addEventListener('change', function() {
        const statusText = this.parentElement.querySelector('.status-text');
        if (this.checked) {
            statusText.textContent = 'Active';
            statusText.classList.remove('text-danger');
            statusText.classList.add('text-success');
        } else {
            statusText.textContent = 'Inactive';
            statusText.classList.remove('text-success');
            statusText.classList.add('text-danger');
        }
    });

    // Reset form when modal is hidden
    document.getElementById('editMegamenuModal').addEventListener('hidden.bs.modal', function() {
        // Reset the form
        document.getElementById('editMegamenuForm').reset();
        
        // Reset image preview
        const preview = document.getElementById('menuImagePreview');
        const uploadText = document.getElementById('uploadText');
        const removeButton = document.getElementById('removeImage');
        
        preview.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
        uploadText.style.display = 'block';
        removeButton.classList.add('d-none');
        
        // Reset status switch
        const statusSwitch = document.getElementById('menuStatus');
        const statusText = statusSwitch.parentElement.querySelector('.status-text');
        statusSwitch.checked = true;
        statusText.textContent = 'Active';
        statusText.classList.remove('text-danger');
        statusText.classList.add('text-success');
        
        // Reset menu type to default (List)
        const menuTypeSwitch = document.getElementById('menuTypeSwitch');
        menuTypeSwitch.checked = false;
        
        // Trigger the change event to update fields visibility
        menuTypeSwitch.dispatchEvent(new Event('change'));
    });

    // Handle menu type toggle
    document.getElementById('menuTypeSwitch').addEventListener('change', function() {
        const descriptionField = document.getElementById('descriptionField');
        const listFields = document.getElementById('listFields');
        
        if (!this.checked) {
            // Text mode
            descriptionField.classList.remove('d-none');
            listFields.classList.add('d-none');
            document.getElementById('menuDescription').required = true;
        } else {
            // List mode
            descriptionField.classList.add('d-none');
            listFields.classList.remove('d-none');
            document.getElementById('menuDescription').required = false;
        }
    });
</script>

<!-- Add this CSS -->
<style>
    /* Custom styling for the toggle switch */
    .form-check-input:checked {
        background-color: var(--phoenix-primary) !important;
        border-color: var(--phoenix-primary) !important;
    }
    
    .form-check-input {
        background-color: #ddd;
        border-color: #ddd;
        transition: all 0.2s ease;
    }
    
    .form-check-input:focus {
        border-color: var(--phoenix-primary);
        box-shadow: 0 0 0 0.25rem rgba(var(--phoenix-primary-rgb), 0.25);
    }

    .fs-sm {
        font-size: 0.875rem;
    }
</style>
